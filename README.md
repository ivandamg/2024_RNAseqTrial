# 2024_RNAseqTrial
Summary statistics of RNAseq trial.  Look at coverage of plant-bacteria, completeness, etc


1. Clean reads with fastp
      cd /data/users/imateusgonzalez/2024_RNAseqTrial/01_RawData
      mkdir ../02_TrimmedData/
     for FILE in $(ls *1.fastq.gz); do echo $FILE; sbatch --partition=pshort_el8 --job-name=$(echo $FILE | cut -d'_' -f1,2)fastp --time=0-02:00:00 --mem-per-cpu=24G --ntasks=1 --cpus-per-task=1 --output=$(echo $FILE | cut -d'_' -f1,2)_fastp.out --error=$(echo $FILE | cut -d'_' -f1,2)_fastp.error --mail-type=END,FAIL --wrap " cd /data/users/imateusgonzalez/2024_RNAseqTrial/01_RawData ; module load FastQC; ~/00_Software/fastp --in1 $FILE --in2 $(echo $FILE | cut -d'_' -f1,2)_R2.fastq.gz --out1 ../02_TrimmedData/$(echo $FILE | cut -d'_' -f1)_1_trimmed.fastq.gz --out2 ../02_TrimmedData/$(echo $FILE | cut -d'_' -f1)_2_trimmed.fastq.gz -h ../02_TrimmedData/$(echo $FILE | cut -d',' -f1)_fastp.html --thread 4; fastqc -t 4 ../02_TrimmedData/$(echo $FILE | cut -d'_' -f1)_1_trimmed.fastq.gz; fastqc -t 4 ../02_TrimmedData/$(echo $FILE | cut -d'_' -f1)_2_trimmed.fastq.gz"; sleep  1; done

2. Index reference hap1 and hap2

       sbatch --partition=pshort_el8 --job-name=StarIndex --time=0-01:00:00 --mem-per-cpu=64G --ntasks=1 --cpus-per-task=1 --output=StarIndex.out --error=StarIndex.error --mail-type=END,FAIL --wrap "cd /data/projects/p782_RNA_seq_Argania_spinosa/21_RNAseqV2/03_haplotype1/00_ref; module load STAR/2.7.10a_alpha_220601-GCC-10.3.0; STAR --runThreadN 1 --runMode genomeGenerate --genomeDir /data/projects/p782_RNA_seq_Argania_spinosa/21_RNAseqV2/03_haplotype1/00_ref --genomeFastaFiles Aspinosa_hap1.fa --sjdbGTFfile Aspinosa_hap1.gff3 --sjdbOverhang 99 --genomeSAindexNbases 10"
       sbatch --partition=pshort_el8 --job-name=StarIndex2 --time=0-01:00:00 --mem-per-cpu=64G --ntasks=1 --cpus-per-task=1 --output=StarIndex2.out --error=StarIndex2.error --mail-type=END,FAIL --wrap "cd /data/projects/p782_RNA_seq_Argania_spinosa/21_RNAseqV2/04_haplotype2/00_ref; module load STAR/2.7.10a_alpha_220601-GCC-10.3.0; STAR --runThreadN 1 --runMode genomeGenerate --genomeDir /data/projects/p782_RNA_seq_Argania_spinosa/21_RNAseqV2/04_haplotype2/00_ref --genomeFastaFiles Aspinosa_hap2.fa --sjdbGTFfile Aspinosa_hap2.gff3 --sjdbOverhang 99 --genomeSAindexNbases 10"

3. Map reads to medicago

          for FILE in $(ls *_1_trimmed.fastq.gz ); do echo $FILE; sbatch --partition=pibu_el8 --job-name=$(echo $FILE | cut -d'_' -f1)_1STAR --time=0-04:00:00 --mem-per-cpu=128G --ntasks=8 --cpus-per-task=1 --output=$(echo $FILE | cut -d'_' -f1)_STAR.out --error=$(echo $FILE | cut -d'_' -f1)_STAR.error --mail-type=END,FAIL --wrap "module load STAR/2.7.10a_alpha_220601-GCC-10.3.0; cd /data/projects/p782_RNA_seq_Argania_spinosa/21_RNAseqV2/02_TrimmedData; STAR --runThreadN 8 --genomeDir /data/projects/p782_RNA_seq_Argania_spinosa/21_RNAseqV2/03_haplotype1/00_ref --readFilesIn $FILE $(echo $FILE | cut -d'_' -f1)_2_trimmed.fastq.gz --readFilesCommand zcat --outFileNamePrefix $(echo $FILE | cut -d'_' -f1)_MappedHap1 --outSAMtype BAM SortedByCoordinate --limitBAMsortRAM 1065539232"; sleep  1; done
          for FILE in $(ls *_1_trimmed.fastq.gz ); do echo $FILE; sbatch --partition=pibu_el8 --job-name=$(echo $FILE | cut -d'_' -f1)_2STAR --time=0-04:00:00 --mem-per-cpu=128G --ntasks=8 --cpus-per-task=1 --output=$(echo $FILE | cut -d'_' -f1)_STAR.out --error=$(echo $FILE | cut -d'_' -f1)_STAR.error --mail-type=END,FAIL --wrap "module load STAR/2.7.10a_alpha_220601-GCC-10.3.0; cd /data/projects/p782_RNA_seq_Argania_spinosa/21_RNAseqV2/02_TrimmedData; STAR --runThreadN 8 --genomeDir /data/projects/p782_RNA_seq_Argania_spinosa/21_RNAseqV2/04_haplotype2/00_ref --readFilesIn $FILE $(echo $FILE | cut -d'_' -f1)_2_trimmed.fastq.gz --readFilesCommand zcat --outFileNamePrefix $(echo $FILE | cut -d'_' -f1)_MappedHap2 --outSAMtype BAM SortedByCoordinate --limitBAMsortRAM 1065539232"; sleep  1; done

